@let isUserLoggedIn = sessionService.isLoggedIn();
<mat-accordion class="header-align">
  <mat-expansion-panel [expanded]="!isUserLoggedIn">
    <mat-expansion-panel-header>
      <mat-panel-title>
        Github
        @if ( isUserLoggedIn ) {
          &nbsp;&nbsp;
          <i class="fa-solid fa-circle-check fa-cl-success"></i>
          &nbsp;&nbsp;
          <i matRipple matTooltip="re-sync user info" (click)="syncInfo($event)" class="fa-solid fa-arrows-rotate"></i>
        }
      </mat-panel-title>
      <mat-panel-description>
        @if (isUserLoggedIn) {
          <span>&nbsp;</span>
          <small>
            <div>Admin: Last synced on {{ sessionService.getUser().lastSync | date: 'YYYY-MM-dd hh:mm a' }}</div>
            <div>Sync type: Full</div>
          </small>
        }
      </mat-panel-description>
    </mat-expansion-panel-header>
    @if (!isUserLoggedIn) {
      <div class="integration-content">
        <button mat-flat-button color="primary" (click)="onGHLogin()">Connect</button>
        <div>Connect Sred.io to Github</div>
      </div>
    }
    @else {
      <div class="integration-content align-end">
        <button mat-flat-button color="warn" (click)="onGHLogout()">Remove <i class="fa-solid fa-user-secret"></i></button>
      </div>
    }
  </mat-expansion-panel>
</mat-accordion>

@if (isUserLoggedIn) {
  <div class="data-container mat-elevation-z4">
    <app-gh-integration-data [ghIntegration]="sessionService.getUser()"/>
  </div>
}
